{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport AppLayout from \"../components/AppLayout\";\nimport { AutoComplete, Button, Card, Carousel, Col, Form, Input, Row, Select, Space, Upload } from 'antd';\nimport { EditOutlined, UploadOutlined } from '@ant-design/icons';\nimport TextArea from \"antd/lib/input/TextArea\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport useInput from \"../hooks/useInput\";\nimport { ADD_POST_REQUEST, LOAD_NEW_POSTS_REQUEST, LOAD_POSTS_REQUEST, NEWLOOK_KEYWORD_REQUEST, REMOVE_IMAGE, UPLOAD_IMAGES_REQUEST } from \"../reducers/post\";\nimport Login from \"./login\";\nimport { useRouter } from \"next/router\";\nimport Router from \"next/router\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faNoteSticky } from \"@fortawesome/free-regular-svg-icons\";\nconst {\n  Meta\n} = Card;\nconst {\n  Option\n} = Select;\nimport styled from \"styled-components\";\nconst OneNewLook = styled.div.withConfig({\n  displayName: \"newLook__OneNewLook\",\n  componentId: \"sc-29otxw-0\"\n})([\".h2-1{margin-left:600px;margin-top:20px;}.col1{float:left;}.card1{width:280px;}.card2{margin-left:15px;width:400px;}.card3{margin-top:25px;margin-left:15px;width:400px;height:210px;}.card4{width:300px;height:630px;}.img1{height:528px;width:280px;}.img2{width:300px;height:630px;}.li1{display:inline-block;}.li2{display:inline-block;margin-left:10px;}.button1{background-color:black;color:white;margin-bottom:10px;}.button2{background-color:black;color:white;margin-bottom:10px;}.button3{left:34%;margin-top:5px;background-color:black;color:white;}.tbody1{text-align:center;}.td1{color:black;text-align:center;}.div1{margin-left:730px;}.div2{text-align:center;}\"]);\nconst NewLook = () => {\n  var _mainPosts$, _mainPosts$$Images$, _mainPosts$2, _mainPosts$2$Images$, _mainPosts$3, _mainPosts$3$Images$, _mainPosts$4, _mainPosts$4$Images$;\n  const dispatch = useDispatch();\n  const imageInput = useRef();\n  const [top, onChangeTop, setTop] = useInput('');\n  const [bottom, onChangeBottom, setBottom] = useInput('');\n  const [dress, onChangeDress, setDress] = useInput('');\n  const [shoes, onChangeShoes, setShoes] = useInput('');\n  const [acc, onChangeAcc, setAcc] = useInput('');\n  const [outer, onChangeOuter, setOuter] = useInput('');\n  const [lookName, onChangeLookName, setLookName] = useInput('');\n  const {\n    imagePaths,\n    addPostDone,\n    mainPosts,\n    newLookKeywords\n  } = useSelector(state => state.post);\n  const {\n    me\n  } = useSelector(state => state.user);\n  const {\n    0: previewImg,\n    1: setPreviewImg\n  } = useState(null);\n  const words = newLookKeywords === null || newLookKeywords === void 0 ? void 0 : newLookKeywords.map(items => ({\n    value: items.name\n  }));\n  const [content, onChangeContent, setContent] = useInput('');\n  useEffect(() => {\n    if (!(me && me.id)) {\n      alert(\"로그인 후 이용 가능합니다.\");\n      Router.push('/');\n    }\n    if (addPostDone === true) {\n      Router.replace('/');\n    }\n    dispatch({\n      type: LOAD_NEW_POSTS_REQUEST\n    });\n  }, [addPostDone, me && me.id]);\n  console.log(\"메인포스트: \", mainPosts);\n  const today = new Date();\n  const year = today.getFullYear(); // 년도\n  const month = today.getMonth() + 1; // 월\n  const date = today.getDate(); // 날짜\n\n  // 월, 날짜가 10보다 작으면 앞에 0을 붙여주기\n  const formattedMonth = month < 10 ? `0${month}` : month;\n  const formattedDate = date < 10 ? `0${date}` : date;\n  const todayDateString = `${year}-${formattedMonth}-${formattedDate}`;\n  const selectTop = useCallback(value => {\n    setTop(value);\n  });\n  const selectBottom = useCallback(value => {\n    setBottom(value);\n  });\n  const selectDress = useCallback(value => {\n    setDress(value);\n  });\n  const selectShoes = useCallback(value => {\n    setShoes(value);\n  });\n  const selectOuter = useCallback(value => {\n    setOuter(value);\n  });\n  const selectAcc = useCallback(value => {\n    setAcc(value);\n  });\n\n  //게시글 업로드 요청\n  const onSubmit = useCallback(() => {\n    if (!top && !bottom && !dress && !shoes && !acc && !outer) {\n      return alert('다섯가지 항목 중 하나 이상은 브랜드명을 작성해야 해요.');\n    }\n    if (!content || !content.trim()) {\n      return alert('오늘의 Look에 대한 내용을 작성하세요.');\n    }\n    if (imagePaths.length === 0) {\n      return alert('오늘의 Look에 필요한 사진을 업로드 해주세요.');\n    }\n    if (!lookName) {\n      return alert('오늘의 Look의 이름을 작성하세요.');\n    }\n    const formData = new FormData();\n    imagePaths.forEach(p => {\n      formData.append('image', p);\n    });\n    formData.append('content', content);\n    formData.append('top', top);\n    formData.append('bottom', bottom);\n    formData.append('dress', dress);\n    formData.append('shoes', shoes);\n    formData.append('acc', acc);\n    formData.append('outer', outer);\n    formData.append('lookName', lookName);\n    formData.append('today', todayDateString);\n    dispatch({\n      type: ADD_POST_REQUEST,\n      data: formData\n    });\n  }, [top, bottom, dress, shoes, acc, outer, content, imagePaths]);\n  const onClickImageUpload = useCallback(() => {\n    imageInput.current.click();\n  }, [imageInput.current]);\n\n  //이미지 변경, 이미지 미리보기\n  const onChangeImages = useCallback(e => {\n    console.log('images', e.target.files);\n    const imageFormData = new FormData();\n    [].forEach.call(e.target.files, f => {\n      imageFormData.append('image', f);\n    });\n    const reader = new FileReader();\n    if (e.target.files[0]) {\n      reader.readAsDataURL(e.target.files[0]);\n    }\n    reader.onloadend = () => {\n      const previewImgUrl = reader.result;\n      if (previewImgUrl) {\n        setPreviewImg(previewImgUrl);\n      }\n    };\n    return dispatch({\n      type: UPLOAD_IMAGES_REQUEST,\n      data: imageFormData\n    });\n  });\n  const NullImage = () => {\n    return __jsx(OneNewLook, null, __jsx(Card, {\n      className: \"card4\"\n    }, __jsx(\"div\", {\n      className: \"div2\"\n    }, __jsx(FontAwesomeIcon, {\n      icon: faNoteSticky,\n      fontSize: 150,\n      style: {}\n    }), __jsx(\"h2\", null, \"\\uC544\\uC9C1 \\uCD5C\\uC2E0 \\uAC8C\\uC2DC\\uAE00\\uC774 \\uB9CE\\uC774 \\uC5C6\\uC5B4\\uC694!\"))));\n  };\n  return __jsx(AppLayout, null, __jsx(OneNewLook, null, __jsx(\"div\", {\n    style: {\n      width: 1120\n    }\n  }, __jsx(Row, null, __jsx(\"h1\", null, \"New DailyLook\"), \" \", __jsx(\"h2\", {\n    className: \"h2-1\"\n  }, \"Recent DailyLook\")), __jsx(Form, {\n    encType: \"multipart/form-data\",\n    onFinish: onSubmit\n  }, __jsx(Col, {\n    className: \"col1\"\n  }, __jsx(Card, {\n    className: \"card1\",\n    cover: __jsx(OneNewLook, null, __jsx(\"img\", {\n      alt: \"example\",\n      src: previewImg ? previewImg : 'https://media.istockphoto.com/id/900575958/vector/dressmaker-model-vector-icon.jpg?s=612x612&w=0&k=20&c=7rnqVC3c7IqiWFrRkWPAZ34h-NAs-pkdsDGR5HYIv94=',\n      ref: imageInput,\n      className: \"img1\"\n    })),\n    actions: [__jsx(Button, {\n      onClick: onClickImageUpload\n    }, __jsx(UploadOutlined, {\n      key: \"edit\"\n    }))]\n  }, __jsx(\"input\", {\n    name: \"image\",\n    type: \"file\",\n    hidden: true,\n    ref: imageInput,\n    onChange: onChangeImages\n  }))), __jsx(Col, {\n    className: \"col1\"\n  }, __jsx(\"div\", null, __jsx(\"ul\", null, __jsx(\"li\", {\n    className: \"li1\"\n  }, __jsx(\"h3\", null, \"\\uB370\\uC77C\\uB9AC\\uB8E9 \\uC81C\\uBAA9\")), __jsx(\"li\", {\n    className: \"li2\"\n  }, __jsx(Input, {\n    value: lookName,\n    onChange: onChangeLookName,\n    showCount: true,\n    maxLength: 20\n  })))), __jsx(\"div\", null, __jsx(Card, {\n    className: \"card2\"\n  }, __jsx(Button, {\n    className: \"button1\",\n    block: true\n  }, \"Information\"), __jsx(\"thead\", null, __jsx(\"tr\", null, __jsx(\"th\", null, \"\\uBD84\\uB958\"), __jsx(\"th\", null, \"\\uBE0C\\uB79C\\uB4DC\\uBA85\"))), __jsx(\"tbody\", {\n    className: \"tbody1\"\n  }, __jsx(\"tr\", null, __jsx(\"td\", null, \" \", __jsx(Input, {\n    disabled: true,\n    defaultValue: \"\\uC0C1\\uC758\",\n    className: \"td1\"\n  })), __jsx(\"td\", null, __jsx(AutoComplete, {\n    id: \"top\",\n    dropdownMatchSelectWidth: 200,\n    options: words,\n    onSelect: selectTop\n  }, __jsx(Input, {\n    id: \"top\",\n    value: top,\n    onChange: onChangeTop,\n    name: \"top\",\n    type: \"text\"\n  })))), __jsx(\"tr\", null, __jsx(\"td\", null, \" \", __jsx(Input, {\n    disabled: true,\n    defaultValue: \"\\uD558\\uC758\",\n    className: \"td1\"\n  })), __jsx(\"td\", null, __jsx(AutoComplete, {\n    id: \"bottom\",\n    dropdownMatchSelectWidth: 200,\n    options: words,\n    onSelect: selectBottom\n  }, __jsx(Input, {\n    id: \"bottom\",\n    value: bottom,\n    onChange: onChangeBottom,\n    name: \"bottom\",\n    type: \"text\"\n  })))), __jsx(\"tr\", null, __jsx(\"td\", null, \" \", __jsx(Input, {\n    disabled: true,\n    defaultValue: \"\\uC6D0\\uD53C\\uC2A4\",\n    className: \"td1\"\n  })), __jsx(\"td\", null, __jsx(AutoComplete, {\n    id: \"dress\",\n    dropdownMatchSelectWidth: 200,\n    options: words,\n    onSelect: selectDress\n  }, __jsx(Input, {\n    value: dress,\n    onChange: onChangeDress,\n    type: \"text\"\n  })))), __jsx(\"tr\", null, __jsx(\"td\", null, \" \", __jsx(Input, {\n    disabled: true,\n    defaultValue: \"\\uC544\\uC6B0\\uD130\",\n    className: \"td1\"\n  })), __jsx(\"td\", null, __jsx(AutoComplete, {\n    id: \"outer\",\n    dropdownMatchSelectWidth: 200,\n    options: words,\n    onSelect: selectOuter\n  }, __jsx(Input, {\n    value: outer,\n    onChange: onChangeOuter,\n    type: \"text\"\n  })))), __jsx(\"tr\", null, __jsx(\"td\", null, \" \", __jsx(Input, {\n    disabled: true,\n    defaultValue: \"\\uC2E0\\uBC1C\",\n    className: \"td1\"\n  })), __jsx(\"td\", null, __jsx(AutoComplete, {\n    id: \"shoes\",\n    dropdownMatchSelectWidth: 200,\n    options: words,\n    onSelect: selectShoes\n  }, __jsx(Input, {\n    value: shoes,\n    onChange: onChangeShoes,\n    type: \"text\"\n  })))), __jsx(\"tr\", null, __jsx(\"td\", null, \" \", __jsx(Input, {\n    disabled: true,\n    defaultValue: \"\\uD328\\uC158\\uC7A1\\uD654\",\n    className: \"td1\"\n  })), __jsx(\"td\", null, __jsx(AutoComplete, {\n    id: \"acc\",\n    dropdownMatchSelectWidth: 200,\n    options: words,\n    onSelect: selectAcc\n  }, __jsx(Input, {\n    id: \"acc\",\n    value: acc,\n    onChange: onChangeAcc,\n    type: \"text\"\n  }))))))), __jsx(Card, {\n    className: \"card3\"\n  }, __jsx(Button, {\n    className: \"button2\",\n    block: true\n  }, \"Daily Record \"), __jsx(Input.TextArea, {\n    value: content,\n    onChange: onChangeContent,\n    showCount: true,\n    maxLength: 250,\n    style: {\n      height: 110,\n      resize: 'none'\n    }\n  })), __jsx(Button, {\n    className: \"button3\",\n    htmlType: \"submit\"\n  }, \"\\uB370\\uC77C\\uB9AC\\uB8E9 \\uB4F1\\uB85D\\uD558\\uAE30\"))), __jsx(\"div\", {\n    className: \"div1\"\n  }, __jsx(Carousel, {\n    style: {},\n    autoplay: true\n  }, __jsx(\"div\", null, mainPosts[0] === undefined ? __jsx(NullImage, null) : __jsx(OneNewLook, null, \" \", __jsx(\"img\", {\n    className: \"img2\",\n    src: `http://localhost:3065/${(_mainPosts$ = mainPosts[0]) === null || _mainPosts$ === void 0 ? void 0 : (_mainPosts$$Images$ = _mainPosts$.Images[0]) === null || _mainPosts$$Images$ === void 0 ? void 0 : _mainPosts$$Images$.src}`\n  }))), __jsx(\"div\", null, mainPosts[1] === undefined ? __jsx(NullImage, null) : __jsx(OneNewLook, null, \" \", __jsx(\"img\", {\n    className: \"img2\",\n    src: `http://localhost:3065/${(_mainPosts$2 = mainPosts[1]) === null || _mainPosts$2 === void 0 ? void 0 : (_mainPosts$2$Images$ = _mainPosts$2.Images[0]) === null || _mainPosts$2$Images$ === void 0 ? void 0 : _mainPosts$2$Images$.src}`\n  }))), __jsx(\"div\", null, mainPosts[2] === undefined ? __jsx(NullImage, null) : __jsx(OneNewLook, null, \" \", __jsx(\"img\", {\n    className: \"img2\",\n    src: `http://localhost:3065/${(_mainPosts$3 = mainPosts[2]) === null || _mainPosts$3 === void 0 ? void 0 : (_mainPosts$3$Images$ = _mainPosts$3.Images[0]) === null || _mainPosts$3$Images$ === void 0 ? void 0 : _mainPosts$3$Images$.src}`\n  }))), __jsx(\"div\", null, mainPosts[3] === undefined ? __jsx(NullImage, null) : __jsx(OneNewLook, null, \" \", __jsx(\"img\", {\n    className: \"img2\",\n    src: `http://localhost:3065/${(_mainPosts$4 = mainPosts[3]) === null || _mainPosts$4 === void 0 ? void 0 : (_mainPosts$4$Images$ = _mainPosts$4.Images[0]) === null || _mainPosts$4$Images$ === void 0 ? void 0 : _mainPosts$4$Images$.src}`\n  }))))))));\n};\nexport default NewLook;","map":null,"metadata":{},"sourceType":"module"}